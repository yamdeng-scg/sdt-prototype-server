<?xml version="1.0" encoding="UTF-8" ?>
<querys>
	<query id="findNotAdmin">
		<![CDATA[
			SELECT * 
				FROM   member
				WHERE  company_id = :companyId 
							AND auth_level > 0
		]]>
	</query>
	<query id="findCanJoin">
		<![CDATA[
			SELECT * 
				FROM   member
				WHERE  company_id = :companyId 
					AND auth_level > 0 AND auth_level < 5
		]]>
	</query>
	<query id="regist">
    CALL regist_member(:companyId, :loginId, :name, :authLevel)
	</query>
	<query id="getByLoginName">
    SELECT c.name            AS company_name, 
       c.use_config_json AS company_use_config_json, 
       m.*
		FROM   member m 
					INNER JOIN company c 
									ON m.company_id = c.id 
		WHERE  m.company_id = :companyId
		  AND  m.login_name = :loginName
	</query>
	<query id="update">
    UPDATE member 
			SET auth_level = IFNULL(:authLevel, auth_level), 
						state = IFNULL(:state, state), 
						profile_image_id = IFNULL(:profileImageId, profile_image_id),
						update_member_id = :loginId
			WHERE  id = :id 
	</query>
	<query id="updateState">
    UPDATE member 
			SET state = :state,
						update_member_id = :loginId
			WHERE  id = :id 
	</query>
	<query id="updateStateAndAuthLevel">
    UPDATE member 
			SET state = :state,
							auth_level = :authLevel,
							update_member_id = :loginId
			WHERE  id = :id 
	</query>
	<query id="getDetail">
    SELECT 
		   c.name            AS company_name, 
       c.use_config_json AS company_use_config_json, 
       m.* 
		FROM   member m 
					INNER JOIN company c 
									ON m.company_id = c.id 
		WHERE  m.id = :id
	</query>
</querys>